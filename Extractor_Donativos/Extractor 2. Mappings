MAP_CLAUBIZ:
MAPPING Load
DISTINCT 
CLAUBIZ,
1;
SQL SELECT CLAUBIZ
FROM DONACIONES_ONG 
WHERE PK_ANYOMES >= $(fechaInicialAnyoMes);

MAP_INTEGRADOS:
MAPPING LOAD 
distinct
PK_CENTRO,
COD_CENTRO_INTEGRA;
SQL SELECT PK_CENTRO, PK_EMPRESA, COD_CENTRO_INTEGRA FROM CENTROS1
WHERE COD_CENTRO_INTEGRA IS NOT NULL AND COD_CENTRO_INTEGRA > 0 AND FK_EMPRESA_CENTRO_INTEGRA = 1
AND PK_EMPRESA = 1 AND COD_CENTRO_INTEGRA = COD_CENTRO_SUPERIOR AND FK_TIPO_CENTRO_SUPERIOR = 'OF';

AUX_MAP_PROVINCIA_INTEGRADOS:
LOAD 
distinct
PK_CENTRO,
FK_PROVINCIA;
SQL SELECT B.PK_CENTRO, B.FK_PROVINCIA FROM (SELECT distinct COD_CENTRO_INTEGRA FROM CENTROS1
WHERE COD_CENTRO_INTEGRA IS NOT NULL AND COD_CENTRO_INTEGRA > 0 AND FK_EMPRESA_CENTRO_INTEGRA = 1
AND PK_EMPRESA = 1) A LEFT JOIN (SELECT FK_PROVINCIA,PK_CENTRO FROM CENTROS1 WHERE PK_EMPRESA = 1) B ON A.COD_CENTRO_INTEGRA = B.PK_CENTRO;
store 'AUX_MAP_PROVINCIA_INTEGRADOS' into 'AUX_MAP_PROVINCIA_INTEGRADOS.qvd' (qvd);   

MAP_TIPO_PERSONA:
MAPPING LOAD 
distinct
PK_NUMPERSO,
COD_TIPO_PERSONA;
SQL SELECT PK_NUMPERSO, COD_TIPO_PERSONA FROM PERSONAS
WHERE PK_EMPRESA_GRUPO = 1;


MAP_NUMPER_NIF:
MAPPING LOAD
PK_NUMPERSO,
NIF;
SQL SELECT PK_NUMPERSO,
NIF_PERSONA_UNICO AS NIF
FROM PERSONAS_NIF
WHERE PK_EMPRESA_GRUPO = 1 and length(NIF_PERSONA_UNICO) = 9;


Map_Numperso_ONG:
Mapping Load
FK_NUM_PER as FK_NUMPERSO_DES,
PK_NUM_ONG
Resident ONG;

Map_NIF_ONG:
Mapping Load
NIF_ONG as NIF,
PK_NUM_ONG
Resident ONG;

Map_SubCanal_BIZ:
Mapping Load
PK_CANAL,
DES_CANAL_DETALLADO_CASTELLANO
Resident CANALES2
where PK_CANAL > 0;

Map_Razon_Social:
Mapping Load
NIF_Entidad,
DES_RAZON_SOCIAL
Resident ENTIDADES;

MAP_CENTRO_DESCRIPCION:
MAPPING LOAD 
distinct
PK_CENTRO,
DES_CENTRO;
SQL SELECT PK_CENTRO, DES_CENTRO FROM CENTROS1;
